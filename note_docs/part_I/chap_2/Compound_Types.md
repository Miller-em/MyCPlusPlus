# 复合类型

## 引言

复合类型是指基于其他类型定义的类型。在C++语言有几种复合类型，下面将介绍其中的两种：引用和指针。

## 引用

> C++11 中新增了一种引用：所谓的“右值引用”，我们将在后面做详细的介绍，这种引用主要用于内置类，严格来说，当我们使用术语“引用(reference)”时，指的其实是“左值引用”

**引用就是为对象起了另外一个名字。**

定义引用基本格式：

```c++
int i = 1;
int &a = i; //a指向i（是i的另一个名字）
int &a;     //报错：引用必须要被初始化
```

## 指针

指针是指向另外一种类型的复合类型。与引用类似，指针也实现了其他对象的间接访问。

与引用的不同点：

- 指针本身就是一个对象，允许对指针赋值和拷贝，而且在指针的生命周期内它可以先后指向几个不同的对象。
- 指针无须在定义时赋初值，和其它内置类型一样，在块作用域内定义的指针如果没有被初始化，也将有一个不确定的值。

### **定义方式：**

```c++
数据类型 *变量名
int *pointer;		//pointer是指向int型对象的指针
```

### **获取对象的地址：**

指针存放某个对象的地址，想要获取该地址，需要使用取地址符(&):

```c++
int ival = 42;
int *p = &ival;	//p存放变量ival的地址，或者说p是指向变量ival的指针
```

### **指针值：**

指针的值（即地址）应属于以下4种状态之一：

- 指向一个对象
- 指向紧邻对象所占空间的下一个位置
- 空指针，意味着指针没有指向任何对象
- 无效指针，也就是上述情况之外的其他值

### **利用指针访问对象**

如果指针指向了一个对象，我们可以使用**解引用符**（操作符*）来访问对象。

```c++
int ival = 42;
int *p = &ival;
cout << *p;
--> 42
```

## 理解复合类型的声明

### 定义多个变量

```c++
int* p1, p2;
```

这种声明是不被允许的，因为第一个`p1`会被理解为`int*`，而第二个`p2`就不知道是`int`类型还是`int*`，编译器会认为是`int`类型，所以就容易造成误解。所以正确的做法是：

```c++
int *p1, *p2;
```

### 指向指针的指针

指针可以通过`*`的个数来区分指针的级别。也就是说`**`表示指向指针的指针：

```c++
int ival = 1024;
int *pi = &ival;
int **ppi = &pi;
```

**指向指针的引用**

引用本身不是一个对象，因此不能够定义指向引用的指针。但是指针是对象，可以定义指针的引用：

```c++
int i = 42;
int* p;				// p是一个int型指针
int* &r = p;		// r是一个对指针p的引用

r = &i;				// r引用了一个指针，因此给r赋给&i就是令p指向i
*r = 0;				// 解引用r得到i,也就是p指向的对象，将i的值改为0
```

> 面对一条比较复杂的指针或引用的声明语句时，从右向左阅读有助于弄清楚它的真实含义